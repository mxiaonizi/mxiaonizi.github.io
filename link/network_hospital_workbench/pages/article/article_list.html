<!DOCTYPE html>
<html>
  <head>
    
    <title>通知公告列表</title>
    
	 <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />  <!--主要是针对IE浏览器的一个设置-->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Pragma" content="no-cache">
	<meta http-equiv="Cache-control" content="no-cache">
	<meta http-equiv="Cache" content="no-cache">
	
	<link rel="stylesheet" href="../../css/reset.css"/>
    <link rel="stylesheet" href="../../css/bootstrap.min.css"/>
    <script type="text/javascript" src="../../js/jquery-1.11.1.min.js"></script>
    <script type="text/javascript" src="../../js/bootstrap.min.js"></script>
    
   
	
	<!--日期选择插件 -->
	<script src="../../js/My97DatePicker/WdatePicker_161206.js"></script>
	
    <!-- 网络医院公共样式库  -->
	<script type="text/javascript" src="../../js/common.js"></script>        
	<link rel="stylesheet" href="../../css/common.css" />	
    
    <link rel="stylesheet" href="../../css/main.css"/>
	
  </head>
  
  <body>
  <input type="hidden" id="pageIndex" />	
    <div class="container col-md-12 contentBox">
        <div class="lepu-box">
	        <form id='iframeList' action="" method="post">
	        	<div class="lepu-m-form">
	          	<p class="lepu-u-title" style="background:#1eb4ab">筛选条件</p>
	          	<div class="lepu-u-box f-ofh">
	          		<ul>
		          		<li class="lepu-u-tag">标题：</li>
		          		<li>
		          		<input style="width:200px" type="text" name="title" value="${title }"/>
						</li>
		          		<li class="lepu-u-tag">文章类型：</li>
		          		<li> <select style="width:150px" name="linkTargetType">
			          		<option value="-2" <c:if test="${linkTargetType==-2 }">selected</c:if> >-请选择-
			          		<option value="0" <c:if test="${linkTargetType==0 }">selected</c:if> >不可点击
			          		<option value="-1" <c:if test="${linkTargetType==-1 }">selected</c:if> >默认文本
			          		</select> </li>
		          		<li class="lepu-u-tag">发布时间：</li>
		          		<li><input name="publishDate" value="${publishDate }" id="d5222"  style="width: 120px;height: 30px; border: 1px solid #d6d6d8;" class="Wdate" type="text" onFocus="WdatePicker({dateFmt:'yyyy-MM-dd'})"/></li>
		          	</ul>
		          	<br>
		          	<ul>
		          		<li class="lepu-u-tag">省市/药店：</li>
		          		<li><select style="width:150px" name="areaType">
			          		<option value="-1" <c:if test="${areaType==-1 }">selected</c:if> >-请选择-
			          		<option value="1" <c:if test="${areaType==1 }">selected</c:if> >省市区
			          		<option value="2" <c:if test="${areaType==2 }">selected</c:if> >药店
			          		<option value="3" <c:if test="${areaType==3 }">selected</c:if> >全国
			          		</select> </li>
		          		<li class="lepu-u-tag">服务站类型：</li>
		          		<li> 
			          		<select style="width:150px" name="institutionType">
			          		<option value="-1" <c:if test="${institutionType==-1 }">selected</c:if> >-请选择-
			          		<option value="2" <c:if test="${institutionType==2 }">selected</c:if> >药店
			          		<option value="8" <c:if test="${institutionType==8 }">selected</c:if> >诊所
			          		</select> 
		          		</li>
		          		<li style="margin-left: 150px;">
		          		<auth:authTag authId="45">
		          		<input type="button" value="新建" onclick="addArticleInit()" class="btn-primary" style="min-width:90px;width:90px;height:40px;">
		          		</auth:authTag>
		          		<input type="button" value="查询" onclick="" class="btn-primary" style="min-width:90px;width:90px;height:40px;">
		          		</li>
		          	</ul>
		          	<!-- <div class="btnBox" style="width:auto ;padding-left:20px;"><input type="button" value="查询" onclick="showPageData(1)" class="btn-primary" style="min-width:90px;width:90px;height:40px;"></div> -->
	          	</div>
          	</form>
       </div>
       <div class="lepu-u-box lepu-u-tab" style="padding:0px;">
           <table class="table table-bordered">
               <thead>
                   <tr>
                   	   <th>公告ID</th>
                       <th>标题</th>
                       <th>文章类型</th>
                       <th>省市/药店</th>
                       <th>服务站类型</th>
                       <th>发布时间</th>
                       <th>显示状态</th>
                       <th>操作</th>
                   </tr>
               </thead>
               <tbody>
                  <c:forEach items="${articleList}" var="item" varStatus="stu">
                   <tr>
        		  	   <td class="pageNum">${item.ArticleID }</td>
                       <td>${item.ArticleTitle}</td>
                       <td>
                       <c:if test="${item.LinkTargetType == 0}">不可点击</c:if>
                       <c:if test="${item.LinkTargetType == -1}">默认文本</c:if>
                       </td>
                       <td>
                       <c:if test="${item.AreaType == 1}">省市区</c:if>
                       <c:if test="${item.AreaType == 2}">药店</c:if>
                       <c:if test="${item.AreaType == 3}">全国</c:if>
                       </td>
                       <td>
                       <c:if test="${item.InstitutionType == 0}">全部</c:if>
                       <c:if test="${item.InstitutionType == 2}">药店</c:if>
                       <c:if test="${item.InstitutionType == 8}">诊所</c:if>
                       </td>
                       <td>${item.PublishDate}</td>
                       <td>
                       <c:if test="${item.RecordIsDeleted == 0}">显示</c:if>
                       <c:if test="${item.RecordIsDeleted == 1}">隐藏</c:if>
                       
                       </td>
                       <td>
                       <a style="text-decoration:underline;color: #1EB4AB" href="javascript:detail22('${item.ArticleID }')">详情</a>
                       <auth:authTag authId="46">
                       <c:if test="${item.RecordIsDeleted == 1}">
                       <a href="javascript:;" style="text-decoration:underline;color: #1EB4AB" data-available="true" onclick="visible('${item.ArticleID }',0,this)">显示</a>
                       </c:if>
                       <c:if test="${item.RecordIsDeleted == 0}">
                       <a href="javascript:;" style="text-decoration:underline;color: #1EB4AB" data-available="true" onclick="visible('${item.ArticleID }',1,this)">隐藏</a>
                       </c:if>
                       </auth:authTag>
                       </td>
                   </tr>
                   </c:forEach>
               </tbody>
           </table>
        </div>
        <div class="lepu-m-page" style="margin-bottom:50px;">${page }</div>
	</div>
	<script type="text/javascript">
		function showPageData(pageNum){
			$("#iframeList").attr("action","${pageContext.request.contextPath}/nhArticle/list?pageIndex="+pageNum);
			$("#iframeList").submit();
		}
		function detail22(p_articleID){
			window.parent.parent.window.addTab2("通知公告详情","article/article_detail.html");		
		} 
		function addArticleInit(){
			window.parent.parent.window.addTab2("通知公告上传","article/article_create.html");		
		}
		function visible(p_articleID,p_isDelete,event){
			if($(event).attr("data-available")=="true"){
				$(event).attr("data-available","false");
				$.ajax({
					url: '${pageContext.request.contextPath}/nhArticle/visible',
					type: 'POST',
					dataType: 'json',
					data: {articleID:p_articleID,recordIsDeleted:p_isDelete},
					success:function(data){
						if(data.Status==200){
							location.reload();	
						}else{
							alert("操作失败");
						}
						$(event).attr("available","true");
					},
					error:function() {
						alert("操作失败");
						$(event).attr("available","true");
					},
				});
			}
			
			
		}
		</script>
</body>
</html>
